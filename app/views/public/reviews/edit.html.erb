<div class="container pt-3">
  <h3><span class="page_title col-10 ml-4">編集画面</span></h3>
  <%= render "layouts/errors", obj: @review %>
  <div class="row">
    <div class="col-md-8 mx-auto my-5">
    <%= form_with model: @review, url: review_path(@review.id), method: :patch do |f| %>
      <div class="form-group">
        <%= f.file_field :image, accept: "image/*" %>
      </div>
      <div class="form-group">
        <h4>タイトル</h4>
        <%= f.text_field :title, class: "form-control" %>
      </div>
      <div class="form-group">
        <h4>店名</h4>
        <%= f.text_field :store_name, class: "form-control" %>
      </div>
      <div class="form-group">
        <h4>住所</h4>
        <%= f.text_field :address, class: "form-control" %>
      </div>
      <div class="form-group">
        <h4>値段</h4>
        <%= f.text_field :price, class: "form-control" %>
      </div>

      <h4>辛さレベル</h4>
      <% if @review.id.nil? %>
        <div class="form-group" id="score">
          <%= f.label :score %>
          <%= f.hidden_field :score, id: :review_score, class: 'form-control' %>
          <div id="post_raty"></div>
        </div>
        <script>
          $(document).on('turbolinks:load', function() {
            let elem = document.querySelector('#post_raty');
            if (elem == null) return;

            elem.innerHTML = ""
            let opt = {
              starOn: "<%= asset_path('fire1.jpg') %>",
              starOff: "<%= asset_path('fire0.jpg') %>",
              starHalf: "<%= asset_path('star-half.png') %>",
              scoreName: 'review[score]',
            };
            raty(elem, opt);
          });
        </script>
      <% else %>
        <div class="form-group">
          <%= render "rate", review: @review %>
        </div>
      <% end %>
      <div class="row d-flex justify-content-start m-5">
        <%= f.collection_check_boxes(:category_ids, Category.all, :id, :category_name) do |category| %>
          <div class="form-check form-check-inline flex flex-wrap">
            <%= category.label do %>
              <%= category.check_box %>
              <%= category.text %>
            <% end %>
          </div>
        <% end %>
      </div>

      <div class="form-group">
        <h4>投稿内容</h4>
        <%= f.text_area :explanation, class: "form-control" %>
      </div>
        <%= f.submit '保存' %>

    <% end %>
    </div>
  </div>
</div>